<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>
        ポケモン150匹企画リターンズ
    </title>
      <script src="http://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js"></script>
      <script src="http://ajax.googleapis.com/ajax/libs/jqueryui/1/jquery-ui.min.js"></script>
      <link rel="stylesheet" href="http://ajax.googleapis.com/ajax/libs/jqueryui/1/themes/humanity/jquery-ui.css">
      <script src="//cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>
    <script>
        $(function () {
            var pokemon_order = [
                  "ピカチュウ",
                  "カイリュー",
                  "ヤドラン",
                  "ピジョン",
                  "コダック",
                  "コラッタ",
                  "ズバット",
                  "ギャロップ",
                  "サンダース",
                  "メノクラゲ",
                  "パウワウ",
                  "カラカラ",
                  "タマタマ",
                  "ガラガラ",
                  "フシギダネ",
                  "アーボ",
                  "イーブイ",
                  "ウツドン",
                  "エレブー",
                  "カビゴン",
                  "カブト",
                  "サイドン",
                  "ジュゴン",
                  "ポリゴン",
                  "ディグダ",
                  "ドードリオ",
                  "ゲンガー",
                  "ドガース",
                  "ルージュラ",
                  "ニャース",
                  "シャワーズ",
                  "クサイハナ",
                  "コクーン",
                  "ゴースト",
                  "イワーク",
                  "ヒトカゲ",
                  "ラッキー",
                  "ラッタ",
                  "オニドリル",
                  "コイル",
                  "レアコイル",
                  "プクリン",
                  "ゼニガメ",
                  "ニョロゾ",
                  "トサキント",
                  "ファイヤー",
                  "ブースター",
                  "フーディン",
                  "ブーバー",
                  "ストライク",
                  "キャタピー",
                  "ピクシー",
                  "シードラ",
                  "ライチュウ",
                  "ヒトデマン",
                  "クラブ",
                  "ニドクイン",
                  "サンドパン",
                  "アズマオウ",
                  "トランセル",
                  "ドードー",
                  "タッツー",
                  "ガーディ",
                  "マンキー",
                  "ドククラゲ",
                  "オニスズメ",
                  "サンド",
                  "パラセクト",
                  "スリープ",
                  "ビードル",
                  "カイロス",
                  "ピジョット",
                  "コイキング",
                  "サイホーン",
                  "マタドガス",
                  "フシギソウ",
                  "カメックス",
                  "シェルダー",
                  "サンダー",
                  "リザード",
                  "ナッシー",
                  "ベトベトン",
                  "ポッポ",
                  "ウツボット",
                  "プリン",
                  "ケーシィ",
                  "ベトベター",
                  "ガルーラ",
                  "ギャラドス",
                  "ゴローニャ",
                  "ピッピ",
                  "イシツブテ",
                  "ゴルダック",
                  "オムナイト",
                  "ゴルバット",
                  "アーボック",
                  "ニドラン♀",
                  "ニドラン♂",
                  "ナゾノクサ",
                  "ニョロボン",
                  "カモネギ",
                  "ラプラス",
                  "ラフレシア",
                  "カブトプス",
                  "ニドリーナ",
                  "バリヤード",
                  "マルマイン",
                  "フシギバナ",
                  "パラス",
                  "リザードン",
                  "コンパン",
                  "ヤドン",
                  "メタモン",
                  "ゴース",
                  "ビリリダマ",
                  "ユンゲラー",
                  "キングラー",
                  "サワムラー",
                  "エビワラー",
                  "カイリキー",
                  "スリーパー",
                  "ゴーリキー",
                  "スターミー",
                  "マダツボミ",
                  "プテラ",
                  "ニドリーノ",
                  "ペルシアン",
                  "ハクリュー",
                  "ミュウツー",
                  "キュウコン",
                  "スピアー",
                  "ベロリンガ",
                  "バタフリー",
                  "ダグトリオ",
                  "ニドキング",
                  "オムスター",
                  "パルシェン",
                  "ニョロモ",
                  "ゴローン",
                  "ロコン",
                  "ケンタロス",
                  "ポニータ",
                  "モンジャラ",
                  "ミニリュウ",
                  "ワンリキー",
                  "モルフォン",
                  "カメール",
                  "ウインディ",
                  "フリーザー",
                  "オコリザル"
            ];
            
            var gengaa_index;
            var isGengaa = false;
            //クッキーの読み込み
            {% if registerViewInfo %}
                gengaa_index = Number("{{ registerViewInfo.gengarNumber }}");
            {% else %}
                gengaa_index = $.cookie("gengaa_index");
            {% endif %}
            if ($.cookie("isGengaa")) {
                isGengaa = true;
            }
            
            var gengaa_text = pokemon_order[gengaa_index];
            
            //初期設定
            if (isGengaa) {
                $("#select_team").val("ゲンガーズ");
                $("#pokemon_name").val(gengaa_text);
            } else {
                $("#select_team").val("ピクシーズ");
            }
            $("#pokemon_name").autocomplete({
                source: function(request, response) {
                    var term = request.term.replace(/[ぁ-ん]/g, function(s) {
                        return String.fromCharCode(s.charCodeAt(0) + 0x60);
                    });
                    var re = new RegExp("^(" + term + ")");
                    response($.grep(pokemon_order, function(value) {
                        return value.match(re);
                    }));
                }
            });
            //イベント処理
            $("#select_team").change(function () {
                if ($(this).val() == "ピクシーズ") {
                    $("#pokemon_name").val("");
                    isGengaa = false;
                } else if ($(this).val() == "ゲンガーズ") {
                    $("#pokemon_name").val(gengaa_text);
                    isGengaa = true;
                }
                alert("チームを変更します");
            });
            $("#submit").click(function () {
                $.removeCookie("isGengaa");
                if (isGengaa) {
                    gengaa_index++;
                    $.cookie("gengaa_index", gengaa_index);
                    $.cookie("isGengaa", true);
                }
            });
        });
        
    </script>
  </head>
  <body>
    <div>登録画面</div>
    
  <form action="/register" method="POST">
      <input type="text" name="pokemon" id="pokemon_name" />
    <select name="team" id="select_team">
      <option value="ピクシーズ">ピクシーズ</option>
      <option value="ゲンガーズ">ゲンガーズ</option>
    </select>
    <input type="radio" name="mode" value="register" id="mode" checked />登録
    <input type="radio" name="mode" value="delete" />削除
      
    <input type="submit" value="送信" id="submit" />
  </form>
  
    <!-- この書き方はjinja2特有の書き方で、if文などを書けます -->
      {{ message }}

  <a href=../>メインページへ戻る</a>
  </body>
</html>
